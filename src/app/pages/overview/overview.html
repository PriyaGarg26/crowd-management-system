<div class="page-container">
    <section class="occupancy-section">
        <h2 class="section-title">Occupancy</h2>
        <div class="occupancy-row">
            <div class="card-wide">
                <div class="metric-left">
                    <h1 class="occ-header">Live Occupancy</h1>
                    <ng-container *ngIf="liveOccupancy$|async as liveOcc">
                        <div class="value">{{liveOcc}}</div>
                    </ng-container>
                    <ng-container *ngIf="liveOccupancyTrend$ | async as trend">
                        <div class="trend" [ngClass]="trend.isPositive ? 'positive' : 'negative'">
                            <mat-icon class="trend-icon">
                                {{ trend.isPositive ? 'trending_up' : 'trending_down' }}
                            </mat-icon>
                            {{ trend.value }}% {{ trend.isPositive ? 'more' : 'less' }} than yesterday
                        </div>
                    </ng-container>
                </div>
                <div class="metric-right">
                    <h1 class="occ-header">Today’s Footfall</h1>
                    <div class="value">{{ footfall$ | async }}</div>
                    <div class="trend" [ngClass]="(liveOccupancyTrend$ | async)?.isPositive ? 'positive' : 'negative'"
                        *ngIf="footFallTrend$ | async as trend">
                        <mat-icon class="trend-icon">
                            {{ trend.isPositive ? 'trending_up' : 'trending_down' }}
                        </mat-icon>
                        {{ trend.value }}% {{ trend.isPositive ? 'more' : 'less' }} than yesterday
                    </div>
                </div>
            </div>
            <div class="card-small">
                <h1 class="occ-header">Avg Dwell Time</h1>
                <div *ngIf="dwellTrend$ | async as dwell">
                    <div class="value">
                        {{ dwell.value.minutes }} minutes {{ dwell.value.seconds }} seconds
                    </div>
                    <div class="trend" [ngClass]="{
    positive: dwell.isPositive && !dwell.isNeutral,
    negative: !dwell.isPositive && !dwell.isNeutral,
    neutral: dwell.isNeutral
  }"> <span *ngIf="dwell.isNeutral">≈ same as yesterday</span>
                        <ng-container *ngIf="!dwell.isNeutral">
                            <mat-icon>
                                {{ dwell.isPositive ? 'trending_up' : 'trending_down' }}
                            </mat-icon>


                            {{ dwell.isPositive ? 'more' : 'less' }} than yesterday
                        </ng-container>
                    </div>
                </div>


            </div>
        </div>
    </section>
    <section class="overall-occupancy">
        <h2 class="section-title">Overall Occupancy</h2>
        <canvas baseChart [data]="occupancyChartData" [options]="occupancyChartOptions" [type]="'line'"></canvas>
    </section>
    <section class="demographics-section">
        <h2 class="section-title">Demographics</h2>
        <div class="demographics-row">
            <div class="demographic-card">
                <h3 class="graph-title">Chart of Demographics</h3>
                <div class="doughtnut-wrapper">
                    <canvas baseChart [data]="genderDoughnutData" [labels]="genderChartLabels"
                        [options]="genderDoughnutOptions" [type]="'doughnut'" [plugins]="genderChartPlugins">
                    </canvas>
                </div>
                <div class="gender-legend">
                    <div class="item male">
                        <span class="material-icons">man</span>
                        <span>{{malePercent}}% Males</span>
                    </div>

                    <div class="item female">
                        <span class="material-icons">woman</span>
                        <span>{{femalePercent}}% Females</span>
                    </div>
                </div>



            </div>
            <div class="demographic-card">

                <h3 class="graph-title">Demographics Analysis</h3>
                <div class="analysis-wrapper">
                    <canvas baseChart [data]="genderAnalysisData" [options]="genderAnalysisOptions"
                        [type]="'line'"></canvas>
                </div>
            </div>
        </div>
    </section>


</div>